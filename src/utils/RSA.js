import JSEncrypt from "jsencrypt/bin/jsencrypt";

export function RSA(val, type) {
  //测试环境密钥
  // let publicStr =
  //   "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAqxflJknlLnobx9PofwTFVzrQ8LhFHxQAYA+HCQPw3mVnydy/x6OW7gGcgSyqj08V8jDbhO60nsX5StZBcPgQsARlxdW1ENgc94FnjOQOuMmP7akWVqGfAylkxqyGJcedK7M/wYURVzKHVhs6Gl9H0lGcJmx4jVswrTd+8kzfYaxKd6iBp6Z70zl2Tlgk/mOXGOSG6ZKGrGdHmve77KLq8lBZktwcCKgyH0eKehcQX8JsmyzCSNA+jY3FSG/gt5g068GLhm3Gu0WsLXKDVWHJSAvAuR5Y55wn6bBZcu3qazMoTmKrLAX9eEyFMH5dxNrIuTfaNozingTNXG3GWcuQZQIDAQAB";
  // let privateStr =
  //   "MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQCrF+UmSeUuehvH0+h/BMVXOtDwuEUfFABgD4cJA/DeZWfJ3L/Ho5buAZyBLKqPTxXyMNuE7rSexflK1kFw+BCwBGXF1bUQ2Bz3gWeM5A64yY/tqRZWoZ8DKWTGrIYlx50rsz/BhRFXModWGzoaX0fSUZwmbHiNWzCtN37yTN9hrEp3qIGnpnvTOXZOWCT+Y5cY5IbpkoasZ0ea97vsouryUFmS3BwIqDIfR4p6FxBfwmybLMJI0D6NjcVIb+C3mDTrwYuGbca7RawtcoNVYclIC8C5HljnnCfpsFly7eprMyhOYqssBf14TIUwfl3E2si5N9o2jOKeBM1cbcZZy5BlAgMBAAECggEBAKDvcx7W93sGZUdMLy/7ft0UeCFWU75uBARX1r9GM7YeUMhymvrhCEGMxnhDWZQ/4fbUukiKeN+4fUxFyXzH+np3SHwVD6JuhqDR2mOOycJL5tS47khC8t34e9Ddy7mR0GegzmHsF2mcH+2A4uCXq2lMVsNV2PeuRVVKFGE6qgymgwEuFSeSSljj548/Ba+Kuw2GbOvpJYFASgQ0delWEDDdtpJmlC6KZpavnA5Nr13aFX9uiaWthoKj+9HIYpTJdwTFi2E3KrA9b+Raym8Nf75ibUUICyZhoYkXu/mhjbEZ97CbuVcWIi4aZch3QCHr5vICCGXOvbtIpt0wh0Ju/CkCgYEA9bEmKkNL2gwcr12a5NwDW99GMwK/1QK3GO23HQ5F1wxLDkZYB4Jn5S3wAS/nR6K6d9a+puP3JoJvRasEUf6HcFIEFjwaO6Hvt3/aT9+CY9xNrvSiFeHRxrOvKEm2UwmO/0JDzVsp7uMSeMUzivhNY69NPJGbWh5cp6LsCK3t9psCgYEAskWFOvSZA8kyL9E5z/VCPv6ktFoT9f+s/v4v+dTFVqVWhAy//DfJbYEIyfToMTTsTTKkzW3wCovcRMWCh2riwaJu/uA4s07sF++Nynzw3hu+SWqhlf4fEBR4Ws6uVnJHT13Q1i4EICxGtwB83It4a3NxIThxtrO0qcHynFABhP8CgYBhoA9zMaRdMvze7cnTcFzhT5m8QTZqdJa+kA53vCkiJx9Xv7nQ2g9gcF1yi09SFqYTYkAFXoXhRmjifO7Nid7VUbGQCDfARDtVZbcgj8Zm2a4Ae/I/0agiVVmfH5MT8bNhWDpKyhOieZXoaStu5/UQTCLbk1vwdioI7mLtm/b3SwKBgD2wHNg3x7MtrfYp+k1h2xidWTUnbnzTinN6VfOnktnWwMdU+iI207bWzcnEu4w7egGEos6LWmLr3r7VccOWUv0aTjpYMIarqrrlpDULYvYYt5IEGgIjO3B/BN63YlB7nv1xw1A6ACd56sZsnshaYsMb4WvTclX8fWm4uVEpxjzVAoGAOCYBjKSXM0B965Ec5KDttV4rZhIlkfPy8AzdRqD9aMtllr5cZajYr2eKP+uP44X5tV2+l2XyDjp2tF2RK+Ye57r3xwIMLYE/1mLDnoZg5t/XsSm+PA+3D76YkDYgtuDMyCq3VH5tG9s5CYQV/3YdODHdfU0rHPLDJQW5y8WGxH8=";
  //线上环境密钥
  // let publicStr = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAlUdZzBbfxO3a2/GrGpTUJl4yK1wSh+5bR0pt4UEQ4KmXWBCa3yhtado+yvUV5N4fwHEL+2eOrvegBVs6G5FUzKF1CUrfAaMBh0ICt1tXNQnS/OjaYPtefm/h3rzhfXRjIB2OHNYy/4OpWo8dc4XMMQZ1/SpKlHAjUBewoJR1V0zJJFxedjwzEGInttT5q+gYLqtUaDXga0P/8zOh+17iQuK8E9FjSHsu/fHsV9+nuOZXQZ/1WGM35MHekZVheTbNmmFuqHd+wIVAK0TitcBbUy0wrLdBIiQ9KUPs6kY/lQSVZrdzCmLXhxazbhQIs/EKMkRJtnP6gAg8lNbY+/Q7hwIDAQAB";
  // let privateStr = "MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQCVR1nMFt/E7drb8asalNQmXjIrXBKH7ltHSm3hQRDgqZdYEJrfKG1p2j7K9RXk3h/AcQv7Z46u96AFWzobkVTMoXUJSt8BowGHQgK3W1c1CdL86Npg+15+b+HevOF9dGMgHY4c1jL/g6lajx1zhcwxBnX9KkqUcCNQF7CglHVXTMkkXF52PDMQYie21Pmr6Bguq1RoNeBrQ//zM6H7XuJC4rwT0WNIey798exX36e45ldBn/VYYzfkwd6RlWF5Ns2aYW6od37AhUArROK1wFtTLTCst0EiJD0pQ+zqRj+VBJVmt3MKYteHFrNuFAiz8QoyREm2c/qACDyU1tj79DuHAgMBAAECggEABY9fx9s+QG5/jVul/Np4QGmXwseuJQP6wGAEUbSDtWp7qZsMua0ezieD2TlhtGGVmyxavuVvihLNEgYA1xAFsY1993ejcMMqhmguA7hSOjaAdk0R/TS/o0P1jL9KQsr3+jU/mtFbmurDfwz/ktLz9QuBj4lot7ipiA0p1gFRkYvLCXUWKNGrQE28LqPkbVEGxkJapVrep2AhVGYdlBp0gkCcJUnFjPQm7ZL+5WUcmbtn0YdmH5kV3W6fEDREsOs9X9x4z0GHR0hDj5F5w96UKzrlCdN1Zw4CJFDa703Iyi/w+g8TtAXVoVIqjBujV30EqAT4QVl+ViMu5r23gbxgsQKBgQDNgz6KHqhDxtWmLxQcOEtRsoWXbOVKRQqte7uJqQXsoWm2Jknv2INN3kWF+R4g/oZf/v3M1uIgiYxgxTRkMZyPSZZpYKd8yNyWR/UGy3XdVKklC+o+HLAQ8GVAxQMqk4pfIt4oCM86F+6fxG58tipQDKEfdY45nbm3DCskjpAoLwKBgQC584kNTJWAH2P5J0KxfLBgnw6s92FdmI90mbdxILzyM1dr4IiEPwXXFZ0J7ysH81JGPPKHawoCbo9RPqhrlq+AlgbVfGyijQyFaLWNiY9kHDBTtOJ8ujcdZph8GJoDfp8cXGJI5fAmswg1Z1igUuWmbTOMl8KnOnO/iaeWsz/0KQKBgEJrgYHoSJ+nGpPcMVaxhv4/gVegVTa8u6e4DrN+EjEZNe4tz8WZp046YSPckLU/LbTG18YlSO4VJm58LeOX+S6CLP+fwmHdFRXo6bMpfM1suEIF6M3sPacr2r2lLtHK33TB8yTjO/5dj7zJIqBhy6kVe9mMB8xtQoF7iFIHVWX3AoGAf32WuLSKR7a974RYeKH5t7U19acCbY58xL/jgr+kbBaBWKgwUSN4mJfr/HSrNx8/iIKe8fOUgEhXIKfqByHgIDQ8aUCOpwA31nwNBgaLdmLRS4LYShXOVe0SnPqtFbpJ0sMQa9Siy5WyChNaM0nCxFFYp4shXVB5LZhue6dYMMkCgYEAqAP/zKuIWFKCj1mXvhaNRrCpnYVbt+OvogpjgGQ+3GybpvIyqWPpHox9+s7P7paK1V5D4IYRVOLpRqvDJO8D7Womxvlu7J0C2hCMAEVUK/Nj4qYRSQ5pfrwsAfe5tq+BPUsRMgpj7vD01Kg2n6PFhUjcDEyOPRkXHqZ9pOIT2sI=";
  let publicStr = "";
  let privateStr = "";
  if (
    window.APP_PUBLIC_KEY &&
    window.APP_PUBLIC_KEY !== "APP_PUBLIC_KEY_PLACEHOLDER"
  ) {
    publicStr = window.APP_PUBLIC_KEY;
  } else {
    publicStr = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAqxflJknlLnobx9PofwTFVzrQ8LhFHxQAYA+HCQPw3mVnydy/x6OW7gGcgSyqj08V8jDbhO60nsX5StZBcPgQsARlxdW1ENgc94FnjOQOuMmP7akWVqGfAylkxqyGJcedK7M/wYURVzKHVhs6Gl9H0lGcJmx4jVswrTd+8kzfYaxKd6iBp6Z70zl2Tlgk/mOXGOSG6ZKGrGdHmve77KLq8lBZktwcCKgyH0eKehcQX8JsmyzCSNA+jY3FSG/gt5g068GLhm3Gu0WsLXKDVWHJSAvAuR5Y55wn6bBZcu3qazMoTmKrLAX9eEyFMH5dxNrIuTfaNozingTNXG3GWcuQZQIDAQAB";
  }
  if (
    window.APP_PRIVATE_KEY &&
    window.APP_PRIVATE_KEY !== "APP_PRIVATE_KEY_PLACEHOLDER"
  ) {
    privateStr = window.APP_PRIVATE_KEY;
  } else {
    privateStr = "MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQCrF+UmSeUuehvH0+h/BMVXOtDwuEUfFABgD4cJA/DeZWfJ3L/Ho5buAZyBLKqPTxXyMNuE7rSexflK1kFw+BCwBGXF1bUQ2Bz3gWeM5A64yY/tqRZWoZ8DKWTGrIYlx50rsz/BhRFXModWGzoaX0fSUZwmbHiNWzCtN37yTN9hrEp3qIGnpnvTOXZOWCT+Y5cY5IbpkoasZ0ea97vsouryUFmS3BwIqDIfR4p6FxBfwmybLMJI0D6NjcVIb+C3mDTrwYuGbca7RawtcoNVYclIC8C5HljnnCfpsFly7eprMyhOYqssBf14TIUwfl3E2si5N9o2jOKeBM1cbcZZy5BlAgMBAAECggEBAKDvcx7W93sGZUdMLy/7ft0UeCFWU75uBARX1r9GM7YeUMhymvrhCEGMxnhDWZQ/4fbUukiKeN+4fUxFyXzH+np3SHwVD6JuhqDR2mOOycJL5tS47khC8t34e9Ddy7mR0GegzmHsF2mcH+2A4uCXq2lMVsNV2PeuRVVKFGE6qgymgwEuFSeSSljj548/Ba+Kuw2GbOvpJYFASgQ0delWEDDdtpJmlC6KZpavnA5Nr13aFX9uiaWthoKj+9HIYpTJdwTFi2E3KrA9b+Raym8Nf75ibUUICyZhoYkXu/mhjbEZ97CbuVcWIi4aZch3QCHr5vICCGXOvbtIpt0wh0Ju/CkCgYEA9bEmKkNL2gwcr12a5NwDW99GMwK/1QK3GO23HQ5F1wxLDkZYB4Jn5S3wAS/nR6K6d9a+puP3JoJvRasEUf6HcFIEFjwaO6Hvt3/aT9+CY9xNrvSiFeHRxrOvKEm2UwmO/0JDzVsp7uMSeMUzivhNY69NPJGbWh5cp6LsCK3t9psCgYEAskWFOvSZA8kyL9E5z/VCPv6ktFoT9f+s/v4v+dTFVqVWhAy//DfJbYEIyfToMTTsTTKkzW3wCovcRMWCh2riwaJu/uA4s07sF++Nynzw3hu+SWqhlf4fEBR4Ws6uVnJHT13Q1i4EICxGtwB83It4a3NxIThxtrO0qcHynFABhP8CgYBhoA9zMaRdMvze7cnTcFzhT5m8QTZqdJa+kA53vCkiJx9Xv7nQ2g9gcF1yi09SFqYTYkAFXoXhRmjifO7Nid7VUbGQCDfARDtVZbcgj8Zm2a4Ae/I/0agiVVmfH5MT8bNhWDpKyhOieZXoaStu5/UQTCLbk1vwdioI7mLtm/b3SwKBgD2wHNg3x7MtrfYp+k1h2xidWTUnbnzTinN6VfOnktnWwMdU+iI207bWzcnEu4w7egGEos6LWmLr3r7VccOWUv0aTjpYMIarqrrlpDULYvYYt5IEGgIjO3B/BN63YlB7nv1xw1A6ACd56sZsnshaYsMb4WvTclX8fWm4uVEpxjzVAoGAOCYBjKSXM0B965Ec5KDttV4rZhIlkfPy8AzdRqD9aMtllr5cZajYr2eKP+uP44X5tV2+l2XyDjp2tF2RK+Ye57r3xwIMLYE/1mLDnoZg5t/XsSm+PA+3D76YkDYgtuDMyCq3VH5tG9s5CYQV/3YdODHdfU0rHPLDJQW5y8WGxH8=";
  }
  if (type == "PU") {
    let encryptPU = new JSEncrypt();
    encryptPU.setPublicKey(publicStr);
    return encryptPU.encrypt(val);
  } else {
    let encryptPR = new JSEncrypt();
    encryptPR.setPrivateKey(privateStr);
    return encryptPR.decrypt(val);
  }
}
